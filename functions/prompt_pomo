# Powerlevel10k custom segment for pomo
# Add 'pomo' to POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS (or LEFT)

function prompt_pomo() {
  # Update segment variables (defined in lib/core.zsh)
  _pomo_update_segment

  # Don't show anything if no timer is running
  if [[ $_POMO_SEGMENT_VISIBLE -eq 0 ]]; then
    return
  fi

  # Output the segment using -e for dynamic evaluation (required for real-time updates)
  # -b: background color, -f: foreground color, -i: icon, -t: text, -s: state, -e: evaluate
  p10k segment -b $_POMO_SEGMENT_COLOR -f 0 -i "$_POMO_SEGMENT_ICON " -t '$_POMO_SEGMENT_TIME' -e -s "$_POMO_SEGMENT_STATE"
}

# Instant prompt version - shows cached/static content during instant prompt
# Since timer state can change, we just call the main function
function instant_prompt_pomo() {
  prompt_pomo
}
